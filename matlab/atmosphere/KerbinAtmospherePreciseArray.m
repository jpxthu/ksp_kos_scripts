function [pPa, pAtm, dens, TK] = KerbinAtmospherePreciseArray(h_meter)

h = 7963.75 .* h_meter ./ 1000 ./ (6371 + 1.25 .* h_meter ./ 1000);

TK = ...
    (h >= 0 & h <= 11) .* (288.15 - 6.5 * h) + ...
    (h > 11 & h <= 20) .* 216.65 + ...
    (h > 20 & h <= 32) .* (196.65 + h) + ...
    (h > 32 & h <= 47) .* (139.05 + 2.8 * h) + ...
    (h > 47 & h <= 51) .* 270.65 + ...
    (h > 51 & h <= 71) .* (413.45 - 2.8 * h) + ...
    (h > 71 & h < 999) .* (356.65 - 2.0 * h);

pPa = ...
    (h >= 0 & h <= 11) .* (101325.0 .* (288.15 ./ (288.15 - 6.5 .* (h - 00))) .^ (34.1632 / -6.5)) + ...
    (h > 11 & h <= 20) .* (22632.06 .* exp(-34.1632 .* (h - 11) ./ 216.65)) + ...
    (h > 20 & h <= 32) .* (5474.889 .* (216.65 ./ (216.65 + h - 20)) .^ 34.1632) + ...
    (h > 32 & h <= 47) .* (868.0187 .* (228.65 ./ (228.65 + 2.8 .* (h - 32))) .^ (34.1632 / 2.8)) + ...
    (h > 47 & h <= 51) .* (110.9063 .* exp(-34.1632 .* (h - 47) ./ 270.65)) + ...
    (h > 51 & h <= 71) .* (66.93887 .* (270.65 ./ (270.65 - 2.8 .* (h - 51))) .^ (34.1632 / -2.8)) + ...
    (h > 71 & h < 999) .* (3.956420 .* (214.65 ./ (214.65 - 2.0 .* (h - 71))) .^ (34.1632 / -2));

pAtm = pPa ./ 101325.0;

dens = pPa ./ TK ./ 287.053;

end
